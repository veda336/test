import React from "react";
import { AccordionComponent, Textbox, Table } from "./components";

// Map type to component
const componentMap = {
  Accordion: AccordionComponent,
  Textbox,
  Table,
};

const MiddlePanel = ({ droppedComponents }) => {
  // Recursive function to render components
  const renderComponent = (component) => {
    // Canvas handled directly here
    if (component.type === "Canvas") {
      return (
        <div
          key={component.id}
          style={{
            display: "flex",
            border: "1px solid #333",
            padding: "8px",
            margin: "4px 0",
            gap: "4px",
            minHeight: "80px",
          }}
        >
          {component.children.map((col) => (
            <div
              key={col.columnIndex}
              style={{
                flex: 1,
                border: "1px dotted gray",
                minHeight: "60px",
                padding: "4px",
                display: "flex",
                justifyContent: "center",
                alignItems: "center",
              }}
            >
              {col.components.length > 0
                ? col.components.map((child) => renderComponent(child))
                : "Drop component here"}
            </div>
          ))}
        </div>
      );
    }

    // Render other components via mapping
    const Component = componentMap[component.type];
    if (!Component) return null;

    return (
      <Component key={component.id} component={component}>
        {/* If Accordion, render children recursively */}
        {component.type === "Accordion" &&
          component.children.map((child) => renderComponent(child))}
      </Component>
    );
  };

  return (
    <div style={{ display: "flex", flexDirection: "column", gap: "8px" }}>
      {droppedComponents.map((component) => renderComponent(component))}
    </div>
  );
};

export default MiddlePanel;